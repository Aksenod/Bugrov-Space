import{r as t,j as e}from"./markdown-vendor-CiFSpwUK.js";import{g as Y,C,i as P}from"./index-D90YyzQ8.js";import"./react-vendor-OvXVS5lI.js";import"./syntax-highlighter-Cw52Qcn0.js";const z=({prototypeHash:a,versionNumber:i,onClose:R})=>{const[n,p]=t.useState(null),[h,c]=t.useState(!0),[d,f]=t.useState(null),[E,w]=t.useState(null),[g,u]=t.useState(!1),j=t.useRef(null),m=t.useRef(null),b=t.useRef(null);return t.useEffect(()=>{(async()=>{try{c(!0);const r=await P.getPublicPrototype(a,i);p(r.prototype.html),w(r.prototype.username),f(null)}catch(r){console.error("Failed to load prototype:",r),f(r?.message||"Не удалось загрузить прототип")}finally{c(!1)}})()},[a,i]),t.useEffect(()=>{if(!n)return;const s=m.current;if(!s)return;const r=l=>{const o=s.getBoundingClientRect();if(!(l.clientX>=o.left&&l.clientX<=o.right&&l.clientY>=o.top&&l.clientY<=o.bottom))return;const v=l.deltaY>0,y=l.deltaY<0;if(v?u(!0):y&&u(!1),s.contentWindow)try{const x=s.contentWindow.scrollY||s.contentWindow.pageYOffset||0,N=s.contentWindow.scrollX||s.contentWindow.pageXOffset||0;s.contentWindow.scrollTo({left:N+l.deltaX,top:x+l.deltaY,behavior:"auto"})}catch{}};return window.addEventListener("wheel",r,{passive:!1,capture:!0}),()=>{window.removeEventListener("wheel",r,{capture:!0})}},[n]),e.jsxs("div",{className:"fixed inset-0 z-[100] bg-black flex flex-col","data-prototype-container":!0,children:[e.jsxs("div",{ref:b,className:"flex items-center justify-between p-4 bg-black/80 backdrop-blur-md border-b border-white/10 transition-transform duration-300 ease-in-out relative z-10",style:{transform:g?"translateY(-100%)":"translateY(0)"},children:[e.jsx("h1",{className:"text-white font-medium",children:"Просмотр прототипа"}),e.jsx("button",{onClick:()=>window.open("https://bugrov.space","_blank"),className:"px-3 py-1.5 bg-gradient-to-r from-indigo-500 via-purple-500 to-indigo-600 text-white text-xs font-medium rounded-full shadow-lg hover:shadow-indigo-500/50 transition-all duration-300 hover:scale-105 active:scale-95 backdrop-blur-sm border border-white/20","aria-label":"Перейти на Bugrov.space",children:e.jsxs("span",{className:"flex flex-col md:flex-row items-center",children:[e.jsx("span",{children:"Сделано на"}),e.jsx("span",{className:"font-bold",children:"Bugrov.space"})]})})]}),e.jsx("div",{ref:j,className:"flex-1 overflow-auto",children:h?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(Y,{size:48,className:"mx-auto animate-spin text-indigo-400"}),e.jsx("p",{className:"text-white/60",children:"Загрузка прототипа..."})]})}):d?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center space-y-4 max-w-md p-6",children:[e.jsx(C,{size:48,className:"mx-auto text-red-400"}),e.jsx("p",{className:"text-white/80 font-medium",children:"Ошибка загрузки"}),e.jsx("p",{className:"text-white/50 text-sm",children:d})]})}):n?e.jsx("iframe",{ref:m,srcDoc:n,className:"w-full h-full border-0",title:"Prototype Preview",sandbox:"allow-same-origin allow-scripts"}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"text-white/50",children:"Прототип не найден"})})})]})};export{z as PublicPrototypePage};
